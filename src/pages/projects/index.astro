---
import {getCollection} from 'astro:content'

import Base from '@/layouts/Base.astro'

const projects = await getCollection('projects')
const topProjects = projects
  .sort((a, b) => (b.data.commits || 0) - (a.data.commits || 0))
  .slice(0, 5)
---

<Base meta={{ title: 'Projects' }}>
  <h2 class="text-2xl font-medium tracking-wide text-lightModeText dark:text-darkModeText w500:text-lg">
    Projects
  </h2>

  <div class="mt-6 grid gap-6">
    {topProjects.map((project) => (
      <article class="rounded-lg border border-accentColor/20 p-5">
        <h3 class="text-xl font-semibold">{project.data.title}</h3>
        <p class="mt-2">{project.data.summary}</p>
        <p class="mt-3 text-sm opacity-80">
          {project.data.role} Â· {project.data.tech.join(' / ')}
        </p>
        <div class="mt-4 flex gap-4">
          {project.data.link && (
            <a class="underline" href={project.data.link}>View</a>
          )}
        </div>
      </article>
    ))}
  </div>
</Base>